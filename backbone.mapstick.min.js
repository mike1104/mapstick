// Generated by CoffeeScript 1.8.0
(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=[].indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(e in this&&this[e]===t)return e;return-1},i={}.hasOwnProperty,n=function(t,e){function n(){this.constructor=t}for(var o in e)i.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};window.MapStick=function(){return{extend:Backbone.Model.extend}},MapStick.ChildViewContainer=function(){function e(e){this._updateLength=t(this._updateLength,this),this.apply=t(this.apply,this),this.call=t(this.call,this),this.remove=t(this.remove,this),this.findByCid=t(this.findByCid,this),this.findByIndex=t(this.findByIndex,this),this.findByCustom=t(this.findByCustom,this),this.findByModelCid=t(this.findByModelCid,this),this.findByModel=t(this.findByModel,this),this.add=t(this.add,this),this._views={},this._indexByModel={},this._indexByCustom={},this._methods=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"],_.each(this._methods,function(t){return function(i){return t[i]=function(){var n;return e=_.values(t._views),n=[e].concat(_.toArray(arguments)),_[i].apply(_,n)}}}(this)),this._updateLength(),_.each(e,this.add)}return e.prototype.add=function(t,e){var i,n;return n=t.cid,this._views[n]=t,(i=t.model)&&(this._indexByModel[i.cid]=n),e&&(this._indexByCustom[e]=n),this._updateLength(),this},e.prototype.findByModel=function(t){return this.findByModelCid(t.cid)},e.prototype.findByModelCid=function(t){var e;return e=this._indexByModel[t],this.findByCid(e)},e.prototype.findByCustom=function(t){var e;return e=this._indexByCustom[t],this.findByCid(e)},e.prototype.findByIndex=function(t){return _.values(this._views)[t]},e.prototype.findByCid=function(t){return this._views[t]},e.prototype.remove=function(t){var e;return e=t.cid,t.model&&delete this._indexByModel[t.model.cid],_.any(this._indexByCustom,function(t){return function(i,n){return i===e?(delete t._indexByCustom[n],!0):void 0}}(this),this),delete this._views[e],this._updateLength(),this},e.prototype.call=function(t){return this.apply(t,_.tail(arguments))},e.prototype.apply=function(t,e){return _.each(this._views,function(){return function(i){return _.isFunction(i[t])?i[t].apply(i,e||[]):void 0}}(this))},e.prototype._updateLength=function(){return this.length=_.size(this._views)},e}(),MapStick.getOption=function(t,i){return t&&i?t.options&&e.call(t.options,i)>=0&&void 0!==t.options[i]?t.options[i]:t[i]:null},MapStick.triggerMethod=function(){var t,e;return t=/(^|:)(\w)/gi,getEventName(match,prefix,eventName)(function(){return eventName.toUpperCase()}),e=function(e){return function(i){var n,o;return o="on"+i.replace(t,getEventName),n=e[o],_.isFunction(e.trigger)&&e.trigger.apply(e,arguments),_.isFunction(n)?n.apply(e,_.tail(arguments)):void 0}}(this)},MapStick.actAsCollection=function(t,e){var i;return i=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"],_.each(i,function(i){return function(n){return t[n]=function(){var t,o;return o=_.values(_.result(i,e)),t=[o].concat(_.toArray(arguments)),_[n].apply(_,t)}}}(this))},MapStick.decodePathString=function(t){return google.maps.geometry?t&&_.isString(t)&&""!==t?google.maps.geometry.encoding.decodePath(t):[]:console.error("please include google.maps.geometry library")},MapStick.encodePathString=function(t){return google.maps.geometry?t?google.maps.geometry.encoding.encodePath(t):void 0:console.error("please include google.maps.geometry library")},MapStick.isClockwise=function(t){var e,i,n,o;return _.isArray(t)||(t=t.getArray()),t.push(t[0]),e=0,o=0,i=null,n=null,_.each(t,function(t){var r,s;return s=t.lng(),r=t.lat(),n&&i&&(e+=s*i,o+=r*n),n=s,i=r}),e-o>0},MapStick.Overlay=function(e){function i(e){null==e&&(e={}),this.updateFromDrawn=t(this.updateFromDrawn,this),this.getDrawnOptions=t(this.getDrawnOptions,this),this.finishDrawing=t(this.finishDrawing,this),this.cancelDrawing=t(this.cancelDrawing,this),this.endDrawing=t(this.endDrawing,this),this.draw=t(this.draw,this),this.render=t(this.render,this),this.clearListeners=t(this.clearListeners,this),this.remove=t(this.remove,this),this.hide=t(this.hide,this),this.show=t(this.show,this),this.set=t(this.set,this),this.get=t(this.get,this),this.triggerOverlayEvent=t(this.triggerOverlayEvent,this),this.setBoundOverlayAttributes=t(this.setBoundOverlayAttributes,this),this.setBoundModelAttributes=t(this.setBoundModelAttributes,this),this.listenToBoundOverlayEvents=t(this.listenToBoundOverlayEvents,this),this.listenToBoundModelChanges=t(this.listenToBoundModelChanges,this),this.bindPosition=t(this.bindPosition,this),this.setBindings=t(this.setBindings,this),this.listenToModel=t(this.listenToModel,this),this.attachOverlayEvents=t(this.attachOverlayEvents,this),this.buildOverlay=t(this.buildOverlay,this),this.googleDrawingOverlayType=t(this.googleDrawingOverlayType,this),this.googleOverlayType=t(this.googleOverlayType,this),this.cid=_.uniqueId("overlay"),this.options=_.extend({},_.result(this,"options"),_.isFunction(e)?e.call(this):e),this.overlayOptions=_.pick(e,this.properties),_.defaults(this.overlayOptions,this.defaultOptions),this[this.overlayType]=this.overlay=this.buildOverlay(this.overlayOptions),_.extend(this,_.pick(e,this.viewOptions)),this.attachOverlayEvents(),this.listenToModel(),this.setBindings(),_.isFunction(this.initialize)&&this.initialize(this.options),this.model.on("destroy",this.remove),"info_window"!==this.overlayType&&this.model.on("draw",this.draw)}return n(i,e),i.prototype.googleOverlayType=function(){return this.overlayType.split("_").map(function(t){return t.charAt(0).toUpperCase()+t.slice(1)}).join("")},i.prototype.googleDrawingOverlayType=function(){return google.maps.drawing.OverlayType[""+this.overlayType.split("_").map(function(t){return t.toUpperCase()}).join("")]},i.prototype.defaultOptions={},i.prototype.properties=[],i.prototype.overlayEvents={},i.prototype.viewOptions=["model","events","map"],i.prototype.bindings={},i.prototype.defaultOverlayEvents=[],i.prototype.modelEvents={},i.prototype.triggerMethod=Marionette.triggerMethod,i.prototype.showing=!1,i.prototype.buildOverlay=function(t){return new(google.maps[this.googleOverlayType()])(t)},i.prototype.attachOverlayEvents=function(){return _.each(this.overlayEventNames,function(t){return function(e){return google.maps.event.addListener(t.overlay,e,function(i){return _.isFunction(t.trigger)&&t.trigger(e,i),t.triggerOverlayEvent(e,i)})}}(this))},i.prototype.listenToModel=function(){return this.model?_.each(this.modelEvents,function(t){return function(e,i){var n;return _.isFunction(n=t[e])?t.model.on(i,n):void 0}}(this)):void 0},i.prototype.setBindings=function(){return _.each(this.bindings,function(t){return function(e,i){var n;if(_.isString(e)&&(e={attribute:e,overlayChanged:!0}),_.isObject(e)){if(e.overlay_attribute=i,"position"===i&&_.isString(e.lat)&&_.isString(e.lng))return t.bindPosition(e);if(n=e.attributes||e.attribute)return _.isString(n)&&(e.attributes=n=[n]),t.setBoundOverlayAttributes(e),t.listenToBoundModelChanges(e),t.listenToBoundOverlayEvents(e)}}}(this))},i.prototype.bindPosition=function(t){var e,i,n,o;return null==t&&(t={}),e=t.lat,i=t.lng,o=function(t){return function(){return t.model.has(e)&&t.model.has(i)?t.set({position:new google.maps.LatLng(t.model.get(e),t.model.get(i))}):void 0}}(this),o(),this.model.on("change:"+e+" change:"+i,function(){return function(t,e,i){var n;return n=(null!=i?i:{}).mapstickChange,n?void 0:o()}}(this)),n=t.overlayEvents||this.defaultOverlayEvents,_.each(n,function(t){return function(n){return google.maps.event.addListener(t.overlay,n,function(){var n,o;return(o=t.get("position"))?(n={},n[e]=o.lat(),n[i]=o.lng(),t.model.set(n,{mapstickChange:!0})):void 0})}}(this))},i.prototype.listenToBoundModelChanges=function(t){var e,i;return null==t&&(t={}),e=t.attributes,i=e.map(function(t){return"change:"+t}).join(" "),this.model.on(i,function(e){return function(i,n,o){var r;return r=(null!=o?o:{}).mapstickChange,r?void 0:e.setBoundOverlayAttributes(t)}}(this))},i.prototype.listenToBoundOverlayEvents=function(t){var e,i;return null==t&&(t={}),i=t.overlay_attribute,(e=t.overlayEvents)?_.isString(e)&&(e=[e]):e||(e=this.defaultOverlayEvents),_.each(e,function(e){return function(n){return google.maps.event.addListener(e.overlay,n,function(o){return"drawn"===n&&("paths"===i?e._listenToPaths(t):"path"===i&&e._listenToPath(t)),e.setBoundModelAttributes(t,o)})}}(this))},i.prototype.setBoundModelAttributes=function(t,e){var i,n,o,r,s;return null==t&&(t={}),t.overlayChanged?(r=t.overlay_attribute,n=t.attributes,i="paths"===r?this.overlay.getPaths():"path"===r?this.overlay.getPath():this.get(r),s={},o=t.overlayChanged,_.isFunction(o)?s=o(i,e):_.isString(o)&&_.isFunction(this[o])?s=this[o](i,e):o===!0&&1===n.length&&(s[n[0]]=i),this.model.set(s,{mapstickChange:!0})):void 0},i.prototype.setBoundOverlayAttributes=function(t){var e,i,n,o,r,s;return null==t&&(t={}),e=t.attributes,o=t.overlay_attribute,i={},_.each(e,function(t){return function(e){return i[e]=t.model.get(e)}}(this)),r={},(n=t.modelChanged)?(s=null,_.isFunction(n)?s=n(i):_.isFunction(this[n])&&(s=this[n](i)),r[o]=s):1===e.length&&(r[o]=this.model.get(e[0])),this.set(r),"paths"===o?this._listenToPaths(t):"path"===o?this._listenToPath(t):void 0},i.prototype.triggerOverlayEvent=function(t,e){var i,n;return(i=this.overlayEvents[t])&&(n=this[i],_.isFunction(n)?n(e):console.error("no such handler for event: '"+t+"'")),n=this["on"+t.split("_").map(function(t){return t.charAt(0).toUpperCase()+t.slice(1)}).join("")],_.isFunction(n)?n(e):void 0},i.prototype.get=function(t){return this.overlay.get(t)},i.prototype.set=function(t,e){return _.isObject(t)?this.overlay.setOptions(t):_.isString(t)?this.overlay.set(t,e):console.error("can't set that")},i.prototype.show=function(t){return this.showing=!0,t&&(this.map=t),this.set("map",this.map)},i.prototype.hide=function(){return this.showing=!1,this.set("map",null)},i.prototype.remove=function(){return this.clearListeners(),this.set("map",null)},i.prototype.clearListeners=function(){return this.overlay?google.maps.event.clearListeners(this.overlay):void 0},i.prototype.render=function(){return this.showing?this.overlay.setMap(this.map):void 0},i.prototype.draw=function(t){return null==t&&(t=this.map),google.maps.drawing?(null==MapStick.drawingManager&&(MapStick.drawingManager=new google.maps.drawing.DrawingManager({map:t,drawingControl:!1})),MapStick.drawingManager.setDrawingMode(this.overlayType),google.maps.event.clearInstanceListeners(MapStick.drawingManager),google.maps.event.addListener(MapStick.drawingManager,"overlaycomplete",function(t){return function(e){return MapStick.drawingManager.getDrawingMode()?t.finishDrawing(e.overlay):void 0}}(this))):console.error("please include google.maps.drawing library")},i.prototype.endDrawing=function(t){return MapStick.drawingManager.setDrawingMode(null),t.setMap(null)},i.prototype.cancelDrawing=function(t){return this.endDrawing(t)},i.prototype.finishDrawing=function(t){return this.endDrawing(t),this.updateFromDrawn(t)},i.prototype.getDrawnOptions=function(){return{}},i.prototype.updateFromDrawn=function(t){return this.overlay.setOptions(this.getDrawnOptions(t)),this.model.trigger("overlay:drawn"),google.maps.event.trigger(this.overlay,"drawn")},i}(Backbone.View),MapStick.Marker=function(e){function i(){return this.getDrawnOptions=t(this.getDrawnOptions,this),i.__super__.constructor.apply(this,arguments)}return n(i,e),i.prototype.overlayType="marker",i.prototype.overlayEventNames=["animation_changed","click","clickable_changed","cursor_changed","dblclick","drag","dragend","draggable_changed","dragstart","flat_changed","icon_changed","mousedown","mouseout","mouseover","mouseup","position_changed","rightclick","shape_changed","title_changed","visible_changed","zindex_changed"],i.prototype.defaultOverlayEvents=["drag","dragend","dragstart","drawn"],i.prototype.properties=["anchorPoint","animation","clickable","crossOnDrag","cursor","draggable","icon","map","opacity","optimized","position","shape","title","visible","zIndex"],i.prototype.getDrawnOptions=function(t){return{position:t.getPosition()}},i}(MapStick.Overlay),MapStick.OverlayWithPath=function(e){function i(){return this._listenToPath=t(this._listenToPath,this),this.getDrawnOptions=t(this.getDrawnOptions,this),this.setOverlayPathFromEncodedString=t(this.setOverlayPathFromEncodedString,this),this.getEncodedPathFromOverlay=t(this.getEncodedPathFromOverlay,this),i.__super__.constructor.apply(this,arguments)}return n(i,e),i.prototype.defaultOptions={path:new google.maps.MVCArray},i.prototype.getEncodedPathFromOverlay=function(){return MapStick.encodePathString(this.overlay.getPath())},i.prototype.setOverlayPathFromEncodedString=function(t){return this.overlay.setPath(MapStick.decodePathString(t))},i.prototype.getDrawnOptions=function(t){return{path:t.getPath()}},i.prototype._listenToPath=function(t){var e;return null==t&&(t={}),e=this.overlay.getPath(),_.each(["insert_at","remove_at","set_at"],function(i){return function(n){return google.maps.event.addListener(e,n,function(e){return i.setBoundModelAttributes(t,e)})}}(this))},i}(MapStick.Overlay),MapStick.Polyline=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.overlayType="polyline",e.prototype.overlayEventNames=["click","dblclick","drag","dragend","dragstart","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],e.prototype.defaultOverlayEvents=["drag","dragend","drawn"],e.prototype.properties=["clickable","draggable","editable","geodesic","icons","map","path","strokeColor","strokeOpacity","strokeWeight","visible","zIndex"],e}(MapStick.OverlayWithPath),MapStick.Polygon=function(e){function i(){return this._listenToPaths=t(this._listenToPaths,this),this.setOverlayPathsFromEncodedStrings=t(this.setOverlayPathsFromEncodedStrings,this),this.getEncodedPathsFromOverlay=t(this.getEncodedPathsFromOverlay,this),this.finishExclusion=t(this.finishExclusion,this),this.drawExclusion=t(this.drawExclusion,this),i.__super__.constructor.apply(this,arguments)}return n(i,e),i.prototype.overlayType="polygon",i.prototype.overlayEventNames=["click","dblclick","drag","dragend","dragstart","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],i.prototype.defaultOverlayEvents=["drag","dragend","drawn"],i.prototype.properties=["zIndex","visible","strokeWeight","strokePosition","strokeOpacity","strokeColor","paths","map","geodesic","fillOpacity","fillColor","editable","draggable","clickable"],i.prototype.drawExclusion=function(){return google.maps.drawing?(null==MapStick.drawingManager&&(MapStick.drawingManager=new google.maps.drawing.DrawingManager({map:this.map,drawingControl:!1})),MapStick.drawingManager.setDrawingMode("polygon"),google.maps.event.clearInstanceListeners(MapStick.drawingManager),google.maps.event.addListener(MapStick.drawingManager,"polygoncomplete",function(t){return function(e){return t.finishExclusion(e)}}(this))):console.error("please include google.maps.drawing library")},i.prototype.finishExclusion=function(t){var e,i;return e=t.getPath(),MapStick.isClockwise(e)===MapStick.isClockwise(this.overlay.getPath())&&(e=new google.maps.MVCArray(e.getArray().reverse())),i=this.overlay.getPaths(),i.push(e),this.overlay.setPaths(i),t.setMap(null),MapStick.drawingManager.setDrawingMode(null),google.maps.event.trigger(this.overlay,"drawn")},i.prototype.getEncodedPathsFromOverlay=function(){return _.collect(this.overlay.getPaths().getArray(),function(){return function(t){return MapStick.encodePathString(t)}}(this))},i.prototype.setOverlayPathsFromEncodedStrings=function(t){return _.isString(t)&&(t=t.split(",")),t=_.collect(t,function(){return function(t){return MapStick.decodePathString(t)}}(this)),this.overlay.setPaths(t)},i.prototype._listenToPaths=function(t){var e;return null==t&&(t={}),e=this.overlay.getPaths(),_.each(["insert_at","remove_at","set_at"],function(i){return function(n){return e.forEach(function(e){return google.maps.event.addListener(e,n,function(){return i.setBoundModelAttributes(t)})})}}(this))},i}(MapStick.OverlayWithPath),MapStick.Rectangle=function(e){function i(){return this.getDrawnOptions=t(this.getDrawnOptions,this),i.__super__.constructor.apply(this,arguments)}return n(i,e),i.prototype.overlayType="rectangle",i.prototype.overlayEventNames=["bounds_changed","click","dblclick","drag","dragend","dragstart","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],i.prototype.defaultOverlayEvents=["drag","dragend","dragstart","drawn"],i.prototype.properties=["bounds","clickable","draggable","editable","fillColor","fillOpacity","map","strokeColor","strokeOpacity","strokePosition","strokeWeight","visible","zIndex"],i.prototype.getDrawnOptions=function(t){return{bounds:t.getBounds()}},i}(MapStick.Overlay),MapStick.Circle=function(e){function i(){return this.getDrawnOptions=t(this.getDrawnOptions,this),i.__super__.constructor.apply(this,arguments)}return n(i,e),i.prototype.overlayType="circle",i.prototype.overlayEventNames=["center_changed","click","dblclick","drag","dragend","dragstart","mousedown","mousemove","mouseout","mouseup","mouseover","radius_changed","rightclick"],i.prototype.defaultOverlayEvents=["drag","dragend","dragstart","drawn"],i.prototype.properties=["center","clickable","draggable","editable","fillColor","fillOpacity","map","radius","strokeColor","strokeOpacity","strokePosition","strokeWeight","visible","zIndex"],i.prototype.getDrawnOptions=function(t){return{center:t.getCenter(),radius:t.getRadius()}},i}(MapStick.Overlay),MapStick.InfoWindow=function(e){function i(){return this.setContentView=t(this.setContentView,this),this.remove=t(this.remove,this),this.close=t(this.close,this),this.open=t(this.open,this),this.isOpen=t(this.isOpen,this),i.__super__.constructor.apply(this,arguments)}return n(i,e),i.prototype.overlayType="info_window",i.prototype.overlayEventNames=["closeclick","content_changed","domready","position_changed","zindex_changed"],i.prototype.properties=["content","disableAutoPan","maxWidth","pixelOffset","position","zIndex"],i.prototype.initialize=function(t){return this.content_view=(null!=t?t:{}).content_view,i.__super__.initialize.apply(this,arguments),this.content_view?this.setContentView():void 0},i.prototype.isOpen=function(){var t;return t=this.get("map"),null!==t&&t!==void 0},i.prototype.open=function(t){var e,i,n,o;return o=null!=t?t:{},i=o.map,e=o.anchor,n=o.position,e?this.overlay.open(i||(i=e.getMap()),e):n&&(this.overlay.setPosition(n),i||(i=this.map))?this.overlay.open(i):void 0},i.prototype.close=function(){return this.overlay.close()},i.prototype.remove=function(){return this.close(),i.__super__.remove.apply(this,arguments)},i.prototype.setContentView=function(t){return null==t&&(t=this.content_view),t.render(),this.overlay.setContent(t.$el[0])},i}(MapStick.Overlay),MapStick.OverlayCollection=function(e){function i(e){this.closeChildren=t(this.closeChildren,this),this.close=t(this.close,this),this.triggerRendered=t(this.triggerRendered,this),this.triggerBeforeRender=t(this.triggerBeforeRender,this),this._initChildViewStorage=t(this._initChildViewStorage,this),this.removeChildView=t(this.removeChildView,this),this.removeItemView=t(this.removeItemView,this),this.buildItemView=t(this.buildItemView,this),this.addItemView=t(this.addItemView,this),this.getItemView=t(this.getItemView,this),this.showCollection=t(this.showCollection,this),this._renderChildren=t(this._renderChildren,this),this.render=t(this.render,this),this.hide=t(this.hide,this),this.show=t(this.show,this),this.addChildView=t(this.addChildView,this),this.removeListeners=t(this.removeListeners,this),this.listenToCollection=t(this.listenToCollection,this),this._initialEvents=t(this._initialEvents,this),this._initialCollection=t(this._initialCollection,this),this.options=_.extend({},_.result(this,"options"),_.isFunction(e)?e.call(this):e),_.extend(this,_.pick(e,this.viewOptions)),this._initChildViewStorage(),this._initialCollection(),this._initialEvents(),this.listenToCollection(),_.isFunction(this.initialize)&&this.initialize(this.options)}return n(i,e),i.prototype.itemType="model",i.prototype.triggerMethod=Marionette.triggerMethod,i.prototype.viewOptions=["collection","model","map"],i.prototype.showing=!1,i.prototype.collectionEvents={},i.prototype._initialCollection=function(){return this.collection.each(function(t){return function(e,i){var n;return(n=t.getItemView(e))?t.addItemView(e,n,i):void 0}}(this))},i.prototype._initialEvents=function(){return this.collection?(this.listenTo(this.collection,"add",this.addChildView),this.listenTo(this.collection,"remove",this.removeItemView),this.listenTo(this.collection,"reset",this.render)):void 0},i.prototype.listenToCollection=function(){return this.collection?_.each(this.collectionEvents,function(t){return function(e,i){var n;return _.isFunction(n=t[e])?t.collection.on(i,n):void 0}}(this)):void 0},i.prototype.removeListeners=function(){return this.collection?(this.stopListening(this.collection,"add"),this.stopListening(this.collection,"remove"),this.stopListening(this.collection,"reset")):void 0},i.prototype.addChildView=function(t){var e;return(e=this.getItemView(t))?this.addItemView(t,e):void 0},i.prototype.show=function(t){return this.showing=!0,t&&(this.map=t),this.children.apply("show")},i.prototype.hide=function(){return this.showing=!1,this.children.apply("hide")},i.prototype.render=function(){return this.isClosed=!1,this.triggerBeforeRender(),this._renderChildren(),this.triggerRendered(),this},i.prototype._renderChildren=function(){return this.closeChildren(),this.showCollection()},i.prototype.showCollection=function(){return this.collection.each(function(t){return function(e){var i;return(i=t.getItemView(e))?t.addItemView(e,i):void 0}}(this))},i.prototype.getItemView=function(){var t;return t=MapStick.getOption(this,"itemView"),t||console.error("An 'itemView' must be specified for class: "+this.constructor.name),t},i.prototype.addItemView=function(t,e,i){var n,o;return n=MapStick.getOption(this,"itemViewOptions"),_.isFunction(n)&&(n=n.call(this,t,i)),o=this.buildItemView(t,e,n),this.triggerMethod("before:item:added",o),this.children.add(o),this.showing?o.show():o.hide(),this.triggerMethod("after:item:added",o),o},i.prototype.buildItemView=function(t,e,i){var n,o;return n=_.extend({model:t,map:this.map},i),o=new e(n)},i.prototype.removeItemView=function(t){var e;return e=this.children.findByModel(t),this.removeChildView(e)},i.prototype.removeChildView=function(t){return t&&(t.close?t.close():t.remove&&t.remove(),this.stopListening(t),this.children.remove(t)),this.triggerMethod("item:removed",t)},i.prototype._initChildViewStorage=function(){return this.children=new MapStick.ChildViewContainer},i.prototype.triggerBeforeRender=function(){return this.triggerMethod("before:render",this),this.triggerMethod("collection:before:render",this)},i.prototype.triggerRendered=function(){return this.triggerMethod("render",this),this.triggerMethod("collection:rendered",this)},i.prototype.close=function(){return this.isClosed?void 0:(this.triggerMethod("collection:before:close"),this.closeChildren(),this.removeListeners(),this.triggerMethod("collection:closed"))},i.prototype.closeChildren=function(){return this.children.each(function(t){return function(e){return t.removeChildView(e)}}(this))},i}(Backbone.View)}).call(this);